<?xml version="1.0"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
    "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
  <!ENTITY legal SYSTEM "legal.xml">
  <!ENTITY GFDL  SYSTEM "fdl-appendix.xml">
  <!ENTITY app "GNOME Power Manager">
  <!ENTITY application "<application>&app;</application>">
  <!ENTITY appversion "2.17.1">
  <!ENTITY manrevision "2.17.1">
]>
<!--
      (Do not remove this comment block.)
  Template Maintained by the GNOME Documentation Project:
	  http://developer.gnome.org/projects/gdp
  Template version: 2.0 beta
  Template last modified Feb 12, 2002
-->

<!-- =============Document Header ============================= -->
<article id="index" lang="en">
<!-- please do not change the id; for translations, change lang to -->
<!-- appropriate code -->

  <articleinfo>
    <title>&application; Manual</title>
    <abstract role="description">
      <para>
        &application; is a session daemon for the GNOME Desktop that
        manages the power settings for your laptop or desktop computer.
      </para>
    </abstract>
    <copyright>
      <year>2006</year>
      <holder>Richard Hughes (richard@hughsie.com)</holder>
    </copyright>

  <!-- translators: uncomment this:

  <copyright>
   <year>2006</year>
   <holder>ME-THE-TRANSLATOR (Latin translation)</holder>
  </copyright>

  -->

<!-- An address can be added to the publisher information.  If a role is
     not specified, the publisher/author is the same for all versions of the
     document.  -->
    <publisher role="maintainer">
      <publishername>Richard Hughes</publishername>
    </publisher>

   &legal;
   <!-- This file  contains link to license for the documentation (GNU FDL), and
        other legal stuff such as "NO WARRANTY" statement. Please do not change
        any of this. -->

    <authorgroup>
      <author role="maintainer">
        <firstname>Richard</firstname>
        <surname>Hughes</surname>
	<email>richard@hughsie.com</email>
      </author>
<!-- This is appropriate place for other contributors: translators,
      maintainers,  etc. Commented out by default.
       <othercredit role="translator">
        <firstname>Latin</firstname>
        <surname>Translator 1</surname>
        <affiliation>
          <orgname>Latin Translation Team</orgname>
          <address> <email>translator@gnome.org</email> </address>
        </affiliation>
        <contrib>Latin translation</contrib>
      </othercredit>
-->
    </authorgroup>

    <revhistory>
      <revision>
        <revnumber>2.0</revnumber>
        <date>2006-08-30</date>
        <revdescription>
          <para role="author">Richard Hughes
            <email>richard@hughsie.com</email>
          </para>
          <para role="publisher">Richard Hughes</para>
        </revdescription>
      </revision>
    </revhistory>

    <legalnotice>
      <title>Feedback</title>
      <para>
        To report a bug or make a suggestion regarding the &app; application or
        this manual, follow the directions in the 
        <ulink url="http://www.gnome.org/projects/gnome-power-manager/"
	  type="http">&application; Contact Page</ulink>.
      </para>
<!-- Translators may also add here feedback address for translations -->
    </legalnotice>
  </articleinfo>

  <indexterm zone="index">
    <primary>&application;</primary>
  </indexterm>
  <indexterm zone="index">
    <primary>gnome-power-manager</primary>
  </indexterm>

<!-- ============= Document Body ============================= -->
<!-- ============= Introduction ============================== -->
<section id="intro">
  <title>Introduction</title>
  <!-- manrevision 2.0 compatibility -->
  <anchor id="aboutex"/>
  <anchor id="notice"/>
  <indexterm>
    <primary>&application;</primary>
    <secondary>Manual</secondary>
    <tertiary>gnome-power-manager</tertiary>
  </indexterm>

  <para>
  The &app; session daemon is a power management daemon
  for the <systemitem>GNOME desktop</systemitem>
  </para>

</section>

<section id="using">
  <title>Usage</title>
  <para>
    <application>&app;</application> is usually started in GNOME startup, but
    you can manually start <application>&app;</application> by doing:
  </para>
  <variablelist>
    <varlistentry>
      <term>Command line</term>
      <listitem>
    	<para>
    	  Type <command>gnome-power-manager --verbose --no-daemon</command>,
          then press <keycap>Return</keycap>:
        </para>
      </listitem>
    </varlistentry>
  </variablelist>
</section>

<section id="notify">
  <title>Notification Messages</title>
  <para>
    When &application; has started, the following notifications may be displayed.
  </para>

  <section id="notify-unplugged">
    <title>AC Adapter Unplugged</title>
    <figure>
      <title>&app; Notification when AC adapter is removed</title>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figures/gpm-unplugged.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
    </figure>
    <note>
      <para>
        You can disable this notification by changing the GConf key
        <command>/apps/gnome-power-manager/notify/discharging</command>.
      </para>
    </note>
  </section>

  <section id="notify-fully-charged">
    <title>Fully Charged</title>
    <figure>
      <title>&app; Notification when laptop primary battery is fully charged</title>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figures/gpm-charged.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
    </figure>
    <note>
      <para>
        You can disable this notification by changing the GConf key
        <command>/apps/gnome-power-manager/notify/fully_charged</command>.
      </para>
    </note>
    <note>
      <para>
        You will only get a repeat notification if your battery percentage charge
        drops below 95% and then is again fully charged.
        This prevents some machines from showing unwanted repeat notifications
        if the battery is incorrectly reporting the charged status.
      </para>
    </note>
  </section>

  <section id="notify-low">
  <title>Power Low</title>
    <para>
      When the battery is low, you will receive the following notification.
      You should consider switching to AC power really soon.
    </para>
    <figure>
      <title>&app; Notification when battery power is low</title>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figures/gpm-low.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
    </figure>
    <note>
      <para>
        You can disable this notification by changing the GConf key
        <command>/apps/gnome-power-manager/notify/low_power</command>.
      </para>
    </note>
  </section>

  <section id="notify-critical">
  <title>Power Critical</title>
    <para>
      When the computer has run out of power, it will show this notification
      explaining what action is required.
      You can change the critical low action using the preferences tool.
    </para>
    <figure>
      <title>&app; Notification when the system power is critically low</title>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figures/gpm-critical.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
    </figure>
  </section>

  <section id="notify-suspend-failure">
  <title>Suspend Failure</title>
    <para>
      When a suspend failure occurs you may get this following warning.
      The most common reason for this notification is that the current user does
      not have permission to suspend or hibernate the computer.
    </para>
    <figure>
      <title>&app; Notification when suspend failure occurs</title>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figures/gpm-suspend-problem.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
    </figure>
    <note>
      <para>
        You can disable this notification by changing the GConf key
        <command>/apps/gnome-power-manager/notify/sleep_failed</command>.
      </para>
    </note>
  </section>
</section>

<section id="statistics">
  <title>Statistics</title>
  <para>
    The statistics program allows you to visualize the power consumption
    of your laptop hardware.
  </para>
  <note>
    <para>
      This has been removed from the information window of previous versions of
      &app; as the data interface is now using DBUS rather than internal IPC.
      This allows other applications to query and display the data if required.
    </para>
  </note>
  <figure id="statistics-graph">
    <title>Power History going from battery power to AC</title>
    <screenshot>
      <mediaobject>
        <imageobject>
          <imagedata fileref="figures/gpm-stats-graph.png" format="PNG"/>
        </imageobject>
      </mediaobject>
    </screenshot>
  </figure>
  <note>
    <para>
      You may not see some options or graphs if your computer does not
      have the required hardware.
      You may also see other hardware not shown here (for example
      UPS devices) but these are treated the same way as other devices.
    </para>
  </note>

  <section id="statistics-charge">
    <title>Charge History</title>
    <para>
      This graph shows the percentage charge available for the composite primary
      battery, so if you have a main laptop battery and an auxiliary battery
      then only the averaged value will be shown.
      A legend is not shown with this graph.
    </para>
  </section>

  <section id="statistics-power">
    <title>Power History</title>
    <para>
      This graph shows the power history charge used by the composite
      primary battery.
      This line represents the amount of power that is either being used to
      charge the batteries in the system, or the power being used by the system
      from the batteries.
      You should see the line go up when processor intensive tasks are
      performed, and down when the system is at idle, or when the screen is
      dimmed.
      A legend is shown with this graph when data events have been received.
    </para>

    <note>
      <para>
        You do will not receive rate data from your computer if it is not
        charging or discharging, or if the computer is suspended.
        This is due to hardware limitations where the rate is only sent from
        the battery management chip, rather than the power management chip on
        the motherboard.
      </para>
    </note>
  </section>

  <section id="statistics-time">
    <title>Estimated Time History</title>
    <para>
      This graph shows the estimated charge history for the composite primary
      battery.
      This line represents the amount of time required until charged, or the
      amount of time until discharge.
      This line should go proportionally up when the rate decreases and down
      when the rate increases.
      A legend is shown with this graph when data events have been received.
    </para>
  </section>
</section>

<section id="preferences">
  <title>Preferences</title>

  <para>The preferences window allows you to control:</para>

  <itemizedlist>
    <listitem>
      <para>
        The LCD brightness when on AC and battery power
      </para>
    </listitem>
    <listitem>
      <para>
        The idle time for the screen power-down and suspend action
      </para>
    </listitem>
    <listitem>
      <para>
        The actions to perform when the laptop lid is closed
      </para>
    </listitem>
    <listitem>
      <para>
        The notification area icon policy
      </para>
    </listitem>
  </itemizedlist>

  <note>
    <para>
      Some sliders or option boxes may be disabled if the GConf policy keys are
      not writable.
      This allows administrators to lock-down the actions that a user can select.
    </para>
  </note>

  <section id="preferences-ac">
    <title>AC Preferences</title>
    <figure id="prefs-ac">
      <title>&app; AC tab</title>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figures/gpm-prefs-ac.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
    </figure>
  </section>

  <section id="preferences-battery">
    <title>Battery Preferences</title>
    <figure id="prefs-processor">
      <title>&app; battery tab</title>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figures/gpm-prefs-battery.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
    </figure>
    <para>
      This allows a powerful computer to reduce the power usage when
      idle, or when the full capabilities are not required.
    </para>
  </section>

  <section id="preferences-general">
    <title>General Preferences</title>
    <figure id="prefs-general">
      <title>&app; general tab</title>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figures/gpm-prefs-general.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
    </figure>
  </section>

  <section id="preferences-idletimes">
    <title>Session and system idle times</title>
    <para>
      <command>gnome-screensaver</command> is a session daemon that monitors user
      input, and if the mouse has not been moved, or the keyboard been pressed then
      it starts a timeout.
      When the value of this timeout reaches the value set in
      <command>gnome-screensaver-preferences</command>, then the login is marked
      as 'session idle'.
      This is when &application; performs all the session idle actions such as
      enabling low-power mode and lowering the laptop panel brightness.
    </para>

    <figure>
      <title>
      Changing the session idle timeout in <command>gnome-screensaver-preferences</command>
      </title>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figures/gs-prefs.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
    </figure>
    <para>
      As soon as the session is marked at idle, &application; starts its own
      'system' timer.
      When the timeout set in <command>gnome-power-preferences</command> is reached,
      and the CPU load is idle, then the idle action is
      performed, which is usually to turn off the screen, or to suspend or hibernate.
    </para>
    <para>
      To make this clearer, the sliders in <command>gnome-power-preferences</command>
      are set to start at the value of the session-timeout + 1 minute, as we cannot
      logically trigger before the session is marked as idle.
      If you adjust the value of the 'session idle' timeout in
      <command>gnome-screensaver-preferences</command> then the start of the sliders
      in <command>gnome-power-preferences</command> will change accordingly.
    </para>
  </section>
</section>

<section id="preferences-advanced">
  <title>Advanced Preferences</title>

  <section id="advanced-preferences-brightness">
    <title>Screen Dim Brightness</title>
    <note>
      <para>
        You can change the idle laptop panel brightness by changing the GConf key
        <command>/apps/gnome-power-manager/backlight/idle_brightness</command>.
      </para>
    </note>
  </section>

  <section id="advanced-preferences-locking">
    <title>Screen Locking</title>
    <para>
      By default, &application; supports a simple locking scheme.
      This means that the screen will lock if set to "Lock screen" in
      gnome-screensaver when the lid is closed, or the system performs a suspend or
      hibernate action.
    </para>
    <para>
      There is a complex locking scheme available for power users that allows
      locking policy to change for the lid, suspend and hibernate actions.
      To enable this complex mode, you will have to disable the GConf key:
    </para>

    <itemizedlist>
      <listitem>
        <para>
          <command>/apps/gnome-power-manager/lock/use_screensaver_settings</command>
        </para>
      </listitem>
    </itemizedlist>
    <para>
      Then the policy keys can be set to force a gnome-screensaver lock and unlock
      when the action is performed:
    </para>

    <itemizedlist>
      <listitem>
        <para>
          <command>/apps/gnome-power-manager/lock/blank_screen</command>
        </para>
      </listitem>
      <listitem>
        <para>
          <command>/apps/gnome-power-manager/lock/suspend</command>
        </para>
      </listitem>
      <listitem>
        <para>
          <command>/apps/gnome-power-manager/lock/hibernate</command>
        </para>
      </listitem>
    </itemizedlist>

    <note>
      <para>
        The lock policy for gnome-screensaver is ignored until the simple mode
        is re-enabled.
      </para>
    </note>
  </section>
</section>

<section id="applets-general">
  <title>GNOME Power Applets</title>

  <section id="applets-brightness">
    <title>Brightness Applet</title>
    <para>
      The brightness applet allows the user to change the brightness
      temporarily without changing the default policy.
      This may be useful if you have got a laptop without brightness
      buttons, as you can now change the brightness easily.
    </para>
    <figure>
      <title>
      Brightness applet drop-down.
      </title>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figures/applet-brightness.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
    </figure>
    <note>
      <para>
        You will not get the slider if your hardware is not supported.
      </para>
    </note>
  </section>

  <section id="applets-inhibit">
    <title>Inhibit Applet</title>
    <para>
      The inhibit applet allows the user to prevent the computer
      auto-sleeping when inactive. This may be required with old or
      proprietary programs such as VMWare or Matlab.
      Just click the icon for the auto-suspend to be inhibited,
      and click it again for normal operation.
    </para>
    <figure>
      <title>
      Inhibit applet in inhibited state.
      </title>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figures/applet-inhibit.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
    </figure>
    <note>
      <para>
        Don't use this applet if you just use GNOME software, instead
        file a bug to make the application use the Inhibit() and
        UnInhibit() methods as this should 'just work'.
      </para>
    </note>
  </section>
</section>

<section id="faq">
  <title>Frequently Asked Questions</title>
  <para>
    These are questions the mailing list gets asked frequently.
  </para>
  <section id="faq-capacity">
    <title>What is battery capacity?</title>
    <para>
      Capacity is how much charge your battery can store compared to its
      manufacturer's guidelines.
    </para>
    <figure>
      <title>
        This graph shows the capacity of a typical lithium ion battery over a
        few hundred charge-discharge cycles.
      </title>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figures/gpm-cell-capacity.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
    </figure>
  </section>

  <section id="faq-suspend-hibernate-differences">
    <title>What's the difference between suspend and hibernate?</title>
    <para>
      The Suspend state is a power saving feature which is the lowest level of
      power consumption that preserves program data in the computer's memory.
      When your computer is in the Suspended state, computation will not be
      performed until normal activity is resumed.
      It will not resume until signaled by an external event such as a keyboard
      button press.
      It generally takes a few seconds to suspend and then resume your computer.
    </para>
    <caution>
      <para>
        You still use a small amount of battery power whilst suspended, so is
        not recommended for the low power action.
        If you remove AC power on a desktop, or run out of battery power on a
        laptop then you will lose your work.
      </para>
    </caution>
    <para>
      The Hibernation state saves the complete state of the computer to hard
      disk and turns off the power, so that the computer appears to be off.
      It will not resume until signaled by an external event such as a
      keyboard button press.
      This is the lowest power sleeping state available.
      If you remove AC power on a desktop, or run out of battery power on a
      laptop then work will not be lost.
      It can take up to a minute or more to hibernate and wake your computer.
    </para>
  </section>

  <section id="faq-dpms-broken-monitor">
    <title>
      My monitor is broken and treats DPMS standby and off states as
      'no-signal' which leaves the monitor powered on.
    </title>
    <para>
      You have to change the DPMS suspend mode &application; uses.
      Open <command>gconf-editor</command>, and then change the keys 
      <literal>/apps/gnome-power-manager/backlight/dpms_method_ac</literal> and
      <literal>/apps/gnome-power-manager/backlight/dpms_method_battery</literal>
      to one of the modes that work, e.g. standby, suspend or off.
    </para>
  </section>

  <section id="faq-longer-suspend">
    <title>
      I've set the computer inactive timeout to one minute and it still
      takes longer than that to suspend.
    </title>
    <para>
      gnome-screensaver is a session daemon that monitors user input, and if
      the mouse has not been moved, or the keyboard been pressed then it
      starts a timeout.
      When the value of this timeout reaches the value set in
      gnome-screensaver-preferences, then the login is marked as
      'session idle'.
      This is when &application; performs all the session idle actions
      such as enabling low-power mode and lowering the laptop panel brightness.
    </para>
    <para>
      As soon as the session is marked at idle, &application; starts
      its own 'system' timer. When the timeout set in gnome-power-preferences
      is reached, and the CPU load is idle, then the idle
      action is performed, which is usually to turn off the screen, or to
      suspend or hibernate.
    </para>
    <para>
      In &application; 2.14 the timeouts were not obviously linked to
      gnome-screensaver, but the timeouts are linked in reality.
      This is because the gnome-screensaver declares the session "idle" and
      then &application; starts.
      Therefore the real time to suspend is actually the GNOME Screensaver
      timeout PLUS the &application; time.
    </para>
    <para>
      In &application; 2.16 and newer, the sliders in
      <command>gnome-power-preferences</command> are set to start at the value
      of the session-timeout + 1 minute, as we cannot logically trigger before
      the session is marked as idle.
      If you adjust the value of the 'session idle' timeout in
      <command>gnome-screensaver-preferences</command> then the start of the
      sliders in <command>gnome-power-preferences</command> will change
      accordingly. This makes it more obvious for new users.
    </para>
  </section>

  <section id="faq-discharge-time-wrong">
    <title>
      My time to discharge is always incorrect due to a faulty battery, what
      can I do?
    </title>
    <para>
      You might be able to use the percentage charge for g-p-m to use as the
      policy data.
      Open <command>gconf-editor</command>, and then change the key 
      <command>/apps/gnome-power-manager/general/use_time_for_policy</command> to false.
      You can do this easily by doing:
      <command>
        gconftool-2 --set --type bool
        /apps/gnome-power-manager/general/use_time_for_policy false
      </command>
    </para>
    <para>
      This should get the policy actions working for you, but of course the
      time remaining will still be incorrect.
    </para>
  </section>

  <section id="faq-ibm-brightness">
    <title>
      Why does not my IBM laptop have the brightness sliders in Power
      Preferences?
    </title>
    <para>
      You need to add to <command>/etc/modprobe.conf</command> the following text:
      <command>options ibm_acpi experimental=1</command>
    </para>
    <para>
      This will enable the experimental features and make the LCD work.
    </para>
    <caution>
      <para>
        You will have to use sudo or a root account to edit this file.
      </para>
    </caution>
  </section>

  <section id="faq-lid-state-confused">
    <title>
      Why does my lid state get confused after suspending or hibernating? (and)
      My laptop suspended when I didn't expect it to when I removed the
      power cord!
    </title>
    <para>
      When you suspend and then resume, ACPI does not seem to send the
      "lid open" event like it should, which I presume is because userspace
      is not in a position to handle the kernel event when we start to thaw
      userspace processes.
    </para>
    <para>
      What we have to do it manually refresh the lid device using HAL when we
      resume, so that the new "lid open" value is propagated to
      &application;.
    </para>
    <para>
      You need to update to a newer version of HAL, or use your updated
      distribution bug-fix packages.
    </para>
  </section>

  <section id="faq-gpm-apm">
    <title>Does &application; support APM?</title>
    <para>
      It supports whatever backends HAL supports!
      At the moment this includes:
    </para>
    <itemizedlist>
      <listitem>
        <para>APM (Pre-2000 Intel computers)</para>
      </listitem>
      <listitem>
        <para>ACPI (most modern Intel compatible computers)</para>
      </listitem>
      <listitem>
        <para>PMU (Powerbook, and iBook PPC computers)</para>
      </listitem>
    </itemizedlist>
  </section>

  <section id="faq-no-suspend-or-hibernate">
    <title>Why does &application; not let me suspend or hibernate?</title>
    <para>
      Before showing items such as "Suspend" and "Hibernate" in the menu
      g-p-m checks two things:
    </para>

    <itemizedlist>
      <listitem>
        <para>
          If HAL can detect a sleep handler in the kernel.
          You can test this doing <command>lshal | grep can_suspend</command>.
          HAL works this out from looking at <command>/sys/power/state</command>,
          and also checking for the presence of suspend2.
        </para>
      </listitem>
      <listitem>
        <para>
          If your administrator (or you!) has disabled the ability to do a
          certain action.
          You can test this using <command>gconftool-2 -R /apps/gnome-power-manager |
          grep can</command> and change the values to be something more suitable.
        </para>
      </listitem>
    </itemizedlist>
    <para>
      For instance, my PowerBook reports from HAL that it can suspend and
      hibernate, but because I know my hibernate does not work,
      I can disable it in <command>gconf-editor</command> removing the option
      from <command>gnome-power-preferences</command> and the drop-down menu.
    </para>
    <para>
      If HAL does not list the options you want, then maybe you need to check
      your BIOS to check that it's running in the correct mode, and also that
      you have compiled your kernel with the correct options.
    </para>
    <para>
      If there are no gconf keys returned by the second check above, you need
      to reinstall your gconf schema as per gnomebug:341256:
      (as root):
    </para>
<programlisting>
export GCONF_CONFIG_SOURCE=`gconftool-2 --get-default-source`
gconftool-2 --makefile-install-rule data/gnome-power-manager.schemas
killall -HUP gconfd-2
</programlisting>
  </section>

  <section id="faq-screen-dim-scroll">
    <title>
      Why does my screen dim or screensaver start even when I'm clicking the
      mouse?
    </title>
    <para>
      If you click the mouse, or scroll the scroll-wheel without moving the
      pointer, then gnome-screensaver will detect the session as being idle.
      This is a limitation of X.org, but is worked around in newer versions
      of gnome-screensaver.
    </para>
  </section>

  <section id="faq-inhibit">
    <title>
      How do I make my application stop the computer auto-suspending?
    </title>
    <para>
      If your application is doing a long operation, you might want to
      disable the ability to suspend for a little while.
      You should use this method if you really don't want the user to be
      able to suspend, or for the computer to save power by hibernating
      or suspending during:
    </para>
    <itemizedlist>
      <listitem>
        <para>Copying files in Nautilus</para>
      </listitem>
      <listitem>
        <para>Doing a long kernel compile or Matlab simulation</para>
      </listitem>
      <listitem>
        <para>During a SELinux relabel</para>
      </listitem>
      <listitem>
        <para>Many others...</para>
      </listitem>
    </itemizedlist>
    <para>
      Then you can use the Inhibit() and UnInhibit() DBUS methods built into
      the newest versions of &application;.
      Here is a simple demonstration in python:
    </para>
<programlisting>
#!/usr/bin/python
import dbus
import time
bus = dbus.Bus(dbus.Bus.TYPE_SESSION)
devobj = bus.get_object('org.freedesktop.PowerManagement', '/org/freedesktop/PowerManagement/Inhibit')
dev = dbus.Interface(devobj, "org.freedesktop.PowerManagement.Inhibit")
cookie = dev.Inhibit('Nautilus', 'Copying files')
time.sleep(100)
dev.UnInhibit(cookie)
</programlisting>
    <para>
      There is an <ulink url="http://svn.gnome.org/viewcvs/gnome-power-manager/trunk/test/gpm-inhibit-test.c?view=markup">example</ulink>
      which shows developers how to add Inhibit and UnInhibit DBUS methods
      into existing programs.
    </para>
  </section>

  <section id="faq-gs-and-gpm-inhibit">
    <title>
      Are &application; and GNOME Screensaver inhibit methods the same?
    </title>
    <para>
      If you call the inhibit methods on gnome-screensaver, then
      gnome-screensaver will not mark your session as idle.
      This means that the screen will not dim, the screensaver will not start
      and the computer will not suspend automatically.
    </para>
    <para>
      While playing a movie full-screen, totem should use the gnome-screensaver
      inhibit methods.
      The idea is that totem does not have to worry at all about power
      management.
      The only thing it wants to assert is that even though there are no key
      presses or mouse movements, the session is still being used.
    </para>
    <para>
      The only applications that should use the &application; inhibit
      method are things that want to assert that the session can be marked as
      idle, but important things are still happening, so it should not power
      down.
      For example, when copying 4.5GB of files in Nautilus, you want the
      screensaver to display, and the LCD panel to dim, but you don't want
      the computer to think that it is idle and shutdown, suspend or hibernate.
    </para>
  </section>

 <section id="faq-spin-down-hdd">
    <title>&application; does not spin down my hard-drive!</title>
    <para>
      After numerous debates, the consensus was that is was not a good idea
      to add this functionality to HAL.
      It was decided user-configurable power management was not really
      required when modern hard disks have really intelligent power management.
    </para>
    <para>
      Here the power consumption data for a typical notebook hard disk
      (IDE/SATA):
    </para>

<programlisting>
Startup (peak, max.)		5.5W 	NC
Seek				2.3W	2.7W
Read (avg.)			2.0W	2.3W
Write (avg.)			2.0W	2.3W
Active idle (avg.)		1.1W	1.2W
Low power idle (avg.)		0.85W	0.9W
Standby (avg.)			0.2W	0.25W
Sleep				0.1W	NC
</programlisting>
    <para>
      The conclusions you can take from this are:
    </para>
    <itemizedlist>
      <listitem>
        <para>
          A disk on low power idle mode needs less than 1 Watt.
          For a normal battery with 50Wh you could run the hard disk for over
          50 hours.
        </para>
      </listitem>
      <listitem>
        <para>
          If you do not read/write from/to the hard disk the disk regulates
          power, but never shuts down the device.
          The reason is easy: you lost more power with each startup than to
          leave the hard disk online somewhere between 'Active idle' and
          'Low power idle' (depends on the model/manufacturer).
        </para>
      </listitem>
      <listitem>
        <para>
          The other reason to leave this to the internal power management of
          the disk is: the time needed to reactivate the device.
          You lose more performance than you lose power between 'Active idle'
          and 'Low power idle'.
        </para>
      </listitem>
      <listitem>
        <para>
          If you use a journaling file system you normally need to flush
          periodically.
          This could run in a race between shut down device and restart
          device by system to flush.
          This means more power consumption as you change nothing.
        </para>
      </listitem>
      <listitem>
        <para>
          You can't set power management for external USB hard disks, because
          you can't send the needed commands over the USB link to the disk.
        </para>
      </listitem>
    </itemizedlist>
  </section>

  <section id="faq-acpi-delay">
    <title>
      I'm running ACPI. Why do events (such as removing the AC adapter)
      take so long to register?
    </title>
    <para>
      One of two things might be the problem.
    </para>
    <itemizedlist>
      <listitem>
        <para>
          HAL might not be running the addon that captures the ACPI event.
        </para>
      </listitem>
      <listitem>
        <para>
          You BIOS could be faulty, and might need a work-around.
          Please send a bug report.
        </para>
      </listitem>
    </itemizedlist>
    <para>
      For the first case, try to find the HAL processes that are running:
      <command>ps -eaf | grep hal</command>
    </para>
    <para>
      And check for the process <command>hald-addon-acpi</command>.
      If it is not being run, then please make sure that HAL is being run
      with the  <command>--retain-privileges</command> option in the
       <command>haldaemon</command> initscript.
      An alternative to this is to use acpid, rather than the kernel proc file.
    </para>
  </section>

  <section id="faq-shell">
    <title>
      How do I query or do actions on &application; from my shell script?
    </title>
    <para>
      You can use the dbus-send program. For example, you can set the DPMS
      mode by running the following:
    </para>
<programlisting>
dbus-send --session \
	  --dest=org.freedesktop.PowerManagement \
	  --type=method_call \
	  --print-reply \
	  --reply-timeout=2000 \
	  /org/freedesktop/PowerManagement \
	  org.freedesktop.PowerManagement.SetDpmsMode \
	  string:suspend
</programlisting>
    <para>
      You can put the system into hibernation using the following:
    </para>
<programlisting>
dbus-send --session \
	  --dest=org.freedesktop.PowerManagement \
	  --type=method_call \
	  --print-reply \
	  --reply-timeout=2000 \
	  /org/freedesktop/PowerManagement \
	  org.freedesktop.PowerManagement.Hibernate
</programlisting>
    <para>
      See the developers guide file in CVS for the full list.
    </para>
  </section>

  <section id="faq-nothing-happens">
    <title>Nothing happens when I click suspend or hibernate!</title>
    <para>
      HAL might not *yet* support your distro, or you might have found a bug
      in &application;.
      Refer to the reporting bugs section.
    </para>
  </section>

  <section id="faq-video-resume">
    <title>
      Why does not my video adaptor come back after a suspend?
      It just displays black!
    </title>
    <para>
      You may need to add a s3 command to your kernel boot string so that the
      kernel can re-initialize your video card.
      See <ulink url="http://www.kernel.org/git/?p=linux/kernel/git/torvalds/linux-2.6.git;a=blob;hb=HEAD;f=Documentation/power/video.txt">this document</ulink>
      for more details, or to see if your system has been identified as
      needing any extra switches.
    </para>
    <note>
      <para>
        Using the new pm-utils should make all this stuff just work in the
        future using HAL fdi matching against machine DMI and video card vendor
        and product IDs.
      </para>
    </note>
  </section>
</section>

<section id="about">
  <title>About</title>
  <para>
    &app; was written by Richard Hughes <email>richard@hughsie.com</email>.
    To find more information about &app;, please visit the
    <ulink url="http://www.gnome.org/projects/gnome-power-manager" type="http">
    &application; web page</ulink>.
  </para>
  <para>
    To report a bug or make a suggestion regarding this application or
    this manual, follow the directions at the
    <ulink url="http://www.gnome.org/projects/gnome-power-manager/bugs.html" type="http">
    &application; Bug Page</ulink>.
  </para>
  <para>This program is distributed under the terms of the GNU
    General Public license as published by the Free Software
    Foundation; either version 2 of the License, or (at your option)
    any later version. A copy of this license can be found at this
    <ulink url="gnome-power-manager:gpl" type="help">link</ulink>, or in the file
    COPYING included with the source code of this program.
  </para>
</section>

</article>
